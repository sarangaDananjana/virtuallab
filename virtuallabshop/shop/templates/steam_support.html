{% load static %}
<!DOCTYPE html>
<html lang="en" class="scroll-smooth">

<head>
    <meta charset="utf-t" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Support Guide — Virtual Lab Games</title>
    <meta name="description" content="A step-by-step guide to installing your patched games using Steam Tools." />

    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        brand: { 50: '#F1F7FF', 100: '#DDEBFF', 200: '#B8D5FF', 300: '#90BDFF', 400: '#5EA1FF', 500: '#2D86FF', 600: '#1E6CE0', 700: '#164FB3', 800: '#0E377F', 900: '#0A2559' },
                        gold: { 50: '#FFFBEB', 100: '#FEF3C7', 200: '#FDE68A', 300: '#FCD34D', 400: '#f6cd45', 500: '#F59E0B', 600: '#D97706', 700: '#B45309', 800: '#92400E', 900: '#78350F' },
                        danger: { 500: '#EF4444' }
                    },
                    animation: {
                        'float': 'float 6s ease-in-out infinite',
                        'pulse-slow': 'pulse 3s cubic-bezier(0.4,0,0.6,1) infinite',
                        'gradient': 'gradient 8s ease infinite',
                    },
                    keyframes: {
                        float: { '0%,100%': { transform: 'translateY(0px)' }, '50%': { transform: 'translateY(-20px)' } },
                        gradient: { '0%,100%': { 'background-position': '0% 50%' }, '50%': { 'background-position': '100% 50%' } }
                    }
                }
            }
        }
    </script>

    <!-- Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link
        href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800;900&family=JetBrains+Mono:wght@400;600;700&family=Maname&display=swap"
        rel="stylesheet">

    <style>
        /* Language styles */
        .lang-si {
            display: none;
        }

        body.sinhala-mode .lang-en {
            display: none;
        }

        body.sinhala-mode .lang-si {
            display: inline;
        }

        /* Gradient text for step counters */
        .step-counter {
            background: linear-gradient(to right, #2D86FF, #FCD34D);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }

        /* Dark background with noise texture */
        .noise {
            position: relative;
            background-color: #101014;
        }

        .noise::before {
            content: "";
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADIAAAAyCAMAAAAp4XiDAAAAUVBMVEWFhYWDg4N3d3dtbW17e3t1dXWBgYGHh4d5eXlzc3OLi4ubm5uVlZWPj4+NjY19fX2JiYl/f39ra2uRkZGZmZlpaWmXl5dvb29xcXGTk5NnZ2c8TV1mAAAAG3RSTlNAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEAvEOwtAAAFVklEQVR4XpWWB67c2BUFb3g557T/hRo9/WUMZHlgr4Bg8Z4qQgQJlHI4A8SzFVrapvmTF9O7dmYRFZ60YiBhJRCgh1FYhiLAmdvX0CzTOpNE77ME0Zty/nWWzchDtiqrmQDeuv3powQ5ta2eN0FY0InkqDD73lT9c9lEzwUNqgFHs9VQce3TVClFCQrSTfOiYkVJQBmpbq2L6iZavPnAPcoU0dSw0SUTt-bCeOMAS80aTVkiWCiVPAQDgr3mezzAte8T2YEoKWNHWoC9GJAomJqZcr齋AccoBxIlEQ9xfDU2KxBCzFGDCCuFAB6YDQC9Bv7R+/uDOd6/vJpe5jOwbfVxE/KaqG9eEzS.png');
            opacity: 0.05;
            pointer-events: none;
        }

        /* Glassmorphism effect for cards */
        .glass {
            background: rgba(255, 255, 255, 0.05);
            backdrop-filter: blur(10px);
            -webkit-backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.1);
        }

        /* Custom radio button styles */
        .radio-button.selected {
            background-color: #2D86FF;
            color: white;
            border-color: #2D86FF;
        }

        /* Section done styling */
        .section-done {
            opacity: 0.5;
        }

        /* This targets the checkmark button inside a completed section to make it stand out */
        .section-done>div:first-of-type>button {
            opacity: 1;
            /* Counteract the parent's opacity */
            background-color: #22c55e;
            /* A nice, vibrant green (Tailwind's green-500) */
        }

        .section-done>div:first-of-type>button svg {
            color: #ffffff;
            /* Make the checkmark inside white for contrast */
        }


        /* GIF container styles */
        .gif-container {
            display: none;
        }

        .gif-container.active {
            display: flex;
            overflow-x: auto;
            gap: 1rem;
            padding-bottom: 1rem;
            scrollbar-width: thin;
            scrollbar-color: #5EA1FF #1a1a1a;
        }

        .gif-container.active::-webkit-scrollbar {
            height: 8px;
        }

        .gif-container.active::-webkit-scrollbar-track {
            background: #1a1a1a;
            border-radius: 4px;
        }

        .gif-container.active::-webkit-scrollbar-thumb {
            background-color: #5EA1FF;
            border-radius: 4px;
        }

        .gif-container img {
            max-width: none;
            width: 90%;
            height: auto;
            border-radius: 0.5rem;
            object-fit: contain;
            flex-shrink: 0;
        }

        @media (min-width: 640px) {
            .gif-container img {
                width: 60%;
            }
        }

        @media (min-width: 1024px) {
            .gif-container img {
                width: 45%;
            }
        }
    </style>
</head>

<body class="bg-aurora text-white selection:bg-gold-400/30 selection:text-white noise">
    <!-- Header -->
    <header class="header-blend sticky top-0 z-[80]">
        <div class="container mx-auto px-4 sm:px-6 lg:px-8">
            <div class="flex items-center justify-between h-16 sm:h-18">
                <!-- Logo -->
                <a href="#" class="flex items-center gap-2 sm:gap-3">
                    <img src="{% static 'images/Virtuallab.png' %}" alt="Virtual Lab logo"
                        class="h-10 sm:h-12 w-auto object-contain" width="48" height="48" decoding="async" />
                    <div class="flex flex-col">
                        <span class="font-black text-base sm:text-lg lg:text-xl tracking-tight">Virtual Lab</span>
                        <span class="text-[10px] sm:text-xs font-medium -mt-0.5">GAMES</span>
                    </div>
                </a>

                <!-- Desktop Navigation -->
                <nav class="hidden lg:flex items-center gap-6 xl:gap-8">
                    <a href="#" class="text-sm font-semibold transition-colors hover:text-gold-400"><span
                            class="lang-en">Home</span><span class="lang-si">මුල් පිටුව</span></a>
                    <a href="#" class="text-sm font-semibold transition-colors hover:text-gold-400"><span
                            class="lang-en">Blog</span><span class="lang-si">බ්ලොග්</span></a>
                    <a href="#" class="text-sm font-semibold transition-colors text-gold-400"><span
                            class="lang-en">Support</span><span class="lang-si">සහය</span></a>
                </nav>

                <!-- Action Buttons -->
                <div class="flex items-center gap-2 sm:gap-3">
                    <button id="langToggleBtn"
                        class="inline-flex items-center justify-center w-10 h-10 rounded-xl bg-white/10 hover:bg-white/15 text-sm font-bold transition-all">EN</button>
                    <a href="#"
                        class="store-pop shine inline-flex items-center gap-1.5 sm:gap-2 px-3 sm:px-5 py-2 sm:py-2.5 rounded-xl bg-gradient-to-r from-brand-500 to-gold-400 text-white text-xs sm:text-sm font-bold shadow-lg hover:shadow-xl transition-all"
                        aria-label="Shop">
                        <svg class="w-4 h-4 sm:w-5 sm:h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24"
                            aria-hidden="true">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                d="M16 11V7a4 4 0 00-8 0v4M5 9h14l1 12H4L5 9z" />
                        </svg>
                        <span class="hidden sm:inline">
                            <span class="lang-en">Shop</span><span class="lang-si">වෙළඳසැල</span>
                        </span>
                    </a>
                </div>
            </div>
        </div>
    </header>

    <main class="py-10 sm:py-14 lg:py-16">
        <div class="container mx-auto px-4 sm:px-6 lg:px-8 max-w-4xl">

            <div class="text-center mb-12">
                <h1 class="text-3xl sm:text-4xl font-black leading-tight tracking-tight">
                    <span class="lang-en">Support Guide</span>
                    <span class="lang-si">සහය මාර්ගෝපදේශය</span>
                </h1>
                <p class="mt-2 text-lg text-white/70 max-w-2xl mx-auto">
                    <span class="lang-en">Follow these steps carefully to set up your game correctly.</span>
                    <span class="lang-si">ඔබේ game එක නිවැරදිව install කිරීමට මෙම පියවර අනුගමනය කරන්න.</span>
                </p>
            </div>

            <!-- All sections are now part of a scrolling guide -->

            <!-- Step 1: Create Steam Account -->
            <section id="steam-account-section" class="mb-12 transition-opacity duration-500">
                <div class="flex items-start justify-between gap-4">
                    <div class="flex items-start gap-4">
                        <div class="step-counter font-black text-6xl">1</div>
                        <div>
                            <h2 class="text-2xl font-bold"><span class="lang-en">Create a New Steam Account</span><span
                                    class="lang-si">අලුත් Steam Account එකක් හදන්න</span></h2>
                            <p class="text-white/70 mt-1"><span class="lang-en">Create a new account and enter the
                                    details below.</span><span class="lang-si">අලුත් ගිණුමක් සාදා විස්තර පහතින් ඇතුලත්
                                    කරන්න.</span></p>
                        </div>
                    </div>
                    <button onclick="markSectionAsDone(this)"
                        class="p-2 rounded-full bg-white/10 hover:bg-green-500/50 transition-colors group flex-shrink-0"
                        aria-label="Mark as done">
                        <svg xmlns="http://www.w3.org/2000/svg"
                            class="h-6 w-6 text-green-400 group-hover:text-white transition-colors" fill="none"
                            viewBox="0 0 24 24" stroke="currentColor">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7" />
                        </svg>
                    </button>
                </div>
                <div class="mt-6 ml-4 pl-12 border-l-2 border-white/10">
                    <form id="steamAccountForm" class="rounded-2xl glass p-6">
                        <p class="text-white/80"><span class="lang-en">First, go to <a
                                    href="https://store.steampowered.com/join/" target="_blank"
                                    class="text-gold-400 hover:underline">store.steampowered.com/join/</a> and create a
                                new Steam Account. Enter the E-mail and Username you used for that here. Save your
                                password in the web browser or remember it well.</span><span class="lang-si">මුලින්ම <a
                                    href="https://store.steampowered.com/join/" target="_blank"
                                    class="text-gold-400 hover:underline">https://store.steampowered.com/join/</a> වෙත
                                ගොස් අලුත් Steam ගිණුමක් සාදන්න. ඒ සඳහා භාවිත කල E-mail සහ Username එක මෙහි ඇතුලත්
                                කරන්න. ඔබගේ මුරපදය වෙබ් බ්‍රවුසරයේ සේව් කරන්න හෝ හොඳින් මතක තබා ගන්න.</span></p>
                        <input type="email" id="steam_email" placeholder="Steam E-mail"
                            class="w-full mt-4 p-3 rounded-lg bg-white/10 border border-white/20 text-white focus:ring-2 focus:ring-brand-400 focus:border-brand-400 outline-none transition"
                            disabled>
                        <input type="text" id="steam_username" placeholder="Steam Username"
                            class="w-full mt-2 p-3 rounded-lg bg-white/10 border border-white/20 text-white focus:ring-2 focus:ring-brand-400 focus:border-brand-400 outline-none transition"
                            disabled>
                        <div id="steam-form-action-container" class="mt-4">
                            <button id="submitSteamDetailsBtn" type="submit"
                                class="w-full p-3 rounded-lg bg-gold-500 text-white font-bold hover:bg-gold-600 transition-all shadow-lg hover:shadow-xl">
                                <span class="lang-en">Submit Details</span>
                                <span class="lang-si">විස්තර ඉදිරිපත් කරන්න</span>
                            </button>
                        </div>
                    </form>
                </div>
            </section>

            <!-- Step 2: Steam Software -->
            <section class="mb-12 transition-opacity duration-500">
                <div class="flex items-start justify-between gap-4">
                    <div class="flex items-start gap-4">
                        <div class="step-counter font-black text-6xl">2</div>
                        <div>
                            <h2 class="text-2xl font-bold"><span class="lang-en">Install Steam Software</span><span
                                    class="lang-si">Steam මෘදුකාංගය Install කරන්න</span></h2>
                        </div>
                    </div>
                    <button onclick="markSectionAsDone(this)"
                        class="p-2 rounded-full bg-white/10 hover:bg-green-500/50 transition-colors group flex-shrink-0"
                        aria-label="Mark as done">
                        <svg xmlns="http://www.w3.org/2000/svg"
                            class="h-6 w-6 text-green-400 group-hover:text-white transition-colors" fill="none"
                            viewBox="0 0 24 24" stroke="currentColor">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7" />
                        </svg>
                    </button>
                </div>
                <div class="mt-6 ml-4 pl-12 border-l-2 border-white/10">
                    <div class="rounded-2xl glass p-6">
                        <h3 class="text-lg font-semibold"><span class="lang-en">Do you have Steam Software on your
                                computer?</span><span class="lang-si">ඔබගේ පරිගණකයේ Steam Software එක තිබේද?</span></h3>
                        <div class="flex mt-4 gap-2">
                            <button
                                class="radio-button flex-1 text-center p-3 rounded-lg border border-white/20 transition hover:bg-white/10"
                                onclick="toggleOption(this, 'steam-yes')"><span class="lang-en">Yes</span><span
                                    class="lang-si">ඔව්</span></button>
                            <button
                                class="radio-button flex-1 text-center p-3 rounded-lg border border-white/20 transition hover:bg-white/10"
                                onclick="toggleOption(this, 'steam-no')"><span class="lang-en">No</span><span
                                    class="lang-si">නැත</span></button>
                        </div>
                        <p id="steam-yes" class="hidden mt-4 text-white/80 p-4 bg-white/5 rounded-lg"><span
                                class="lang-en">Log in with the username and password of the newly created Steam
                                account.</span><span class="lang-si">ඔබ අලුතෙන් සෑදූ ස්ටීම් එකවුන්ට් එකෙ Username
                                Password ඇතුලත් කර ලොග් වෙන්න.</span></p>
                        <p id="steam-no" class="hidden mt-4 text-white/80 p-4 bg-white/5 rounded-lg"><span
                                class="lang-en">If not, go to <a href="https://store.steampowered.com/about/"
                                    target="_blank" class="text-gold-400 hover:underline">this link</a> to download and
                                log in with the username and password of the newly created Steam account.</span><span
                                class="lang-si">නැති නම් <a href="https://store.steampowered.com/about/" target="_blank"
                                    class="text-gold-400 hover:underline">මේ ලින්ක් එකෙන්</a> ගොස් ඩවුන්ලෝඩ් කර ඔබ
                                අලුතෙන් සෑදූ ස්ටීම් එකවුන්ට් එකෙ Username, Password ඇතුලත් කර ලොග් වෙන්න.</span></p>
                    </div>
                </div>
            </section>

            <!-- Step 3: Disable Anti-Virus -->
            <section class="mb-12 transition-opacity duration-500">
                <div class="flex items-start justify-between gap-4">
                    <div class="flex items-start gap-4">
                        <div class="step-counter font-black text-6xl">3</div>
                        <div>
                            <h2 class="text-2xl font-bold"><span class="lang-en">Disable Anti-Virus</span><span
                                    class="lang-si">Anti-Virus අක්‍රීය කරන්න</span></h2>
                            <p class="text-white/70 mt-1"><span class="lang-en">Temporarily disable your Anti-Virus to
                                    prevent file conflicts.</span><span class="lang-si">ගොනු ගැටුම් වැලැක්වීමට ඔබගේ
                                    Anti-Virus තාවකාලිකව අක්‍රීය කරන්න.</span></p>
                        </div>
                    </div>
                    <button onclick="markSectionAsDone(this)"
                        class="p-2 rounded-full bg-white/10 hover:bg-green-500/50 transition-colors group flex-shrink-0"
                        aria-label="Mark as done">
                        <svg xmlns="http://www.w3.org/2000/svg"
                            class="h-6 w-6 text-green-400 group-hover:text-white transition-colors" fill="none"
                            viewBox="0 0 24 24" stroke="currentColor">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7" />
                        </svg>
                    </button>
                </div>
                <div class="mt-6 ml-4 pl-12 border-l-2 border-white/10 space-y-8">
                    <div class="rounded-2xl glass p-6">
                        <h3 class="text-lg font-semibold"><span class="lang-en">To disable Windows Defender, select your
                                computer's Windows version.</span><span class="lang-si">Windows Defender එක disable
                                කිරීම සදහා ඔබගේ පරිගණකය වින්ඩෝස් එක තෝරන්න.</span></h3>
                        <div class="flex mt-4 gap-2">
                            <button
                                class="radio-button selected flex-1 text-center p-3 rounded-lg border border-white/20 transition hover:bg-white/10"
                                onclick="showGifs('win10', event)">Windows 10</button>
                            <button
                                class="radio-button flex-1 text-center p-3 rounded-lg border border-white/20 transition hover:bg-white/10"
                                onclick="showGifs('win11', event)">Windows 11</button>
                        </div>
                        <div id="win10-gifs" class="gif-container active mt-4"><img
                                src="{% static 'images/support/win10/1.gif' %}" alt="Windows 10 Step 1"><img
                                src="{% static 'images/support/win10/2.gif' %}" alt="Windows 10 Step 2"><img
                                src="{% static 'images/support/win10/3.gif' %}" alt="Windows 10 Step 3"><img
                                src="{% static 'images/support/win10/4.gif' %}" alt="Windows 10 Step 4"><img
                                src="{% static 'images/support/win10/5.gif' %}" alt="Windows 10 Step 5"></div>
                        <div id="win11-gifs" class="gif-container mt-4"><img src="{% static 'images/win11_1.gif' %}"
                                alt="Windows 11 Step 1"><img src="{% static 'images/win11_2.gif' %}"
                                alt="Windows 11 Step 2"><img src="{% static 'images/win11_3.gif' %}"
                                alt="Windows 11 Step 3"><img src="{% static 'images/win11_4.gif' %}"
                                alt="Windows 11 Step 4"><img src="{% static 'images/win11_5.gif' %}"
                                alt="Windows 11 Step 5"></div>
                    </div>
                    <div class="rounded-2xl glass p-6">
                        <p class="text-white/80"><span class="lang-en">If you have installed another anti-virus software
                                other than Windows Defender (like McAfee or Kaspersky), search on YouTube for "how to
                                turn off real-time protection in &lt;name of anti-virus software&gt;" and follow the
                                instructions. Example: "how to turn off real-time protection in McAfee".</span><span
                                class="lang-si">ඔබ වින්ඩෝස් ඩිෆෙන්ඩර් එකට අමතරව වෙනත් ඇන්ටි වයිරස් මෘදුකාංගයක් (මැකාෆි,
                                කැස්පර්ස්කී වැනි) ඉන්ස්ටෝල් කර ඇත්නම් යූටියුබ් එකේ "how to turn off real time protection
                                in &lt;ඇන්ටි වයිරස් මෘදුකාංගයේ නම&gt;" ලෙස සර්ච් කර ඒ අනුව උපදෙස් පිලිපදින්න. උදා: "how
                                to turn off real time protection in makafee".</span></p>
                    </div>
                </div>
            </section>

            <!-- Step 4 & 5: Required Software -->
            <section class="mb-12 transition-opacity duration-500">
                <div class="flex items-start justify-between gap-4">
                    <div class="flex items-start gap-4">
                        <div class="step-counter font-black text-6xl">4</div>
                        <div>
                            <h2 class="text-2xl font-bold"><span class="lang-en">Install Required Tools</span><span
                                    class="lang-si">අවශ්‍ය Tools Install කරන්න</span></h2>
                        </div>
                    </div>
                    <button onclick="markSectionAsDone(this)"
                        class="p-2 rounded-full bg-white/10 hover:bg-green-500/50 transition-colors group flex-shrink-0"
                        aria-label="Mark as done">
                        <svg xmlns="http://www.w3.org/2000/svg"
                            class="h-6 w-6 text-green-400 group-hover:text-white transition-colors" fill="none"
                            viewBox="0 0 24 24" stroke="currentColor">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7" />
                        </svg>
                    </button>
                </div>
                <div class="mt-6 ml-4 pl-12 border-l-2 border-white/10 space-y-8">
                    <div class="rounded-2xl glass p-6">
                        <p class="text-white/80 mb-4"><span class="lang-en">Temporarily stop your Windows updates with
                                this software (until you finish playing this game).</span><span class="lang-si">මෙම
                                මෘදුකාංගය මගින් ඔබගේ වින්ඩෝස් අප්ඩේට්ස් තාවකාලිකව නවත්වන්න(ඔබ මේ ගේම් එක ප්ලේ කර අවසන්
                                වන තුරු).</span> <a href="#"
                                class="text-gold-400 font-semibold hover:underline">[Download Tool]</a></p>
                    </div>
                    <div class="rounded-2xl glass p-6">
                        <h3 class="text-lg font-semibold"><span class="lang-en">Do you have Steam Tools software on your
                                computer?</span><span class="lang-si">ඔබේ පරිඝණකයේ Steam Tools මෘදුකාංගය තිබේද?</span>
                        </h3>
                        <div class="flex mt-4 gap-2">
                            <button
                                class="radio-button flex-1 text-center p-3 rounded-lg border border-white/20 transition hover:bg-white/10"
                                onclick="toggleOption(this, 'steam-tools-yes')"><span class="lang-en">Yes</span><span
                                    class="lang-si">ඔව්</span></button>
                            <button
                                class="radio-button flex-1 text-center p-3 rounded-lg border border-white/20 transition hover:bg-white/10"
                                onclick="toggleOption(this, 'steam-tools-no')"><span class="lang-en">No</span><span
                                    class="lang-si">නැත</span></button>
                        </div>
                        <p id="steam-tools-yes" class="hidden mt-4 text-white/80 p-4 bg-white/5 rounded-lg"><span
                                class="lang-en">Great. Please open it for the next step.</span><span
                                class="lang-si">හොඳයි. කරුණාකර ඊළඟ පියවර සඳහා එය විවෘත කරන්න.</span></p>
                        <p id="steam-tools-no" class="hidden mt-4 text-white/80 p-4 bg-white/5 rounded-lg"><span
                                class="lang-en">Download and install the Steam Tools software from here and open
                                it.</span><span class="lang-si">මෙම Steam Tools මෘදුකාංගය මෙතනින් ඩවුන්ලෝඩ් කර ඉන්ස්ටෝල්
                                කර එය ඕපන් කරන්න.</span> <a href="#"
                                class="text-gold-400 font-semibold hover:underline">Download Steam Tools</a></p>
                    </div>
                    <div class="rounded-2xl glass p-6">
                        <h3 class="text-lg font-semibold"><span class="lang-en">Do you have WinRAR software on your
                                computer?</span><span class="lang-si">ඔබේ පරිඝණකයේ WinRAR මෘදුකාංගය තිබේද?</span></h3>
                        <div class="flex mt-4 gap-2">
                            <button
                                class="radio-button flex-1 text-center p-3 rounded-lg border border-white/20 transition hover:bg-white/10"
                                onclick="toggleOption(this, 'winrar-yes')"><span class="lang-en">Yes</span><span
                                    class="lang-si">ඔව්</span></button>
                            <button
                                class="radio-button flex-1 text-center p-3 rounded-lg border border-white/20 transition hover:bg-white/10"
                                onclick="toggleOption(this, 'winrar-no')"><span class="lang-en">No</span><span
                                    class="lang-si">නැත</span></button>
                        </div>
                        <p id="winrar-yes" class="hidden mt-4 text-white/80 p-4 bg-white/5 rounded-lg"><span
                                class="lang-en">Excellent, you're all set for the file extraction step.</span><span
                                class="lang-si">විශිෂ්ටයි, ඔබ ගොනු උපුටා ගැනීමේ පියවර සඳහා සූදානම්.</span></p>
                        <p id="winrar-no" class="hidden mt-4 text-white/80 p-4 bg-white/5 rounded-lg"><span
                                class="lang-en">Download and install WinRAR software from here.</span><span
                                class="lang-si">WinRAR මෘදුකාංගය මෙතනින් ඩවුන්ලෝඩ් කර ඉන්ස්ටෝල් කරන්න.</span> <a
                                href="#" class="text-gold-400 font-semibold hover:underline">Download WinRAR</a></p>
                    </div>
                </div>
            </section>

            <!-- Step 5: Select Game & Patch -->
            <section class="mb-12 transition-opacity duration-500">
                <div class="flex items-start justify-between gap-4">
                    <div class="flex items-start gap-4">
                        <div class="step-counter font-black text-6xl">5</div>
                        <div>
                            <h2 class="text-2xl font-bold"><span class="lang-en">Select & Patch Your Game</span><span
                                    class="lang-si">ඔබේ Game එක තෝරා Patch කරන්න</span></h2>
                        </div>
                    </div>
                    <button onclick="markSectionAsDone(this)"
                        class="p-2 rounded-full bg-white/10 hover:bg-green-500/50 transition-colors group flex-shrink-0"
                        aria-label="Mark as done">
                        <svg xmlns="http://www.w3.org/2000/svg"
                            class="h-6 w-6 text-green-400 group-hover:text-white transition-colors" fill="none"
                            viewBox="0 0 24 24" stroke="currentColor">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7" />
                        </svg>
                    </button>
                </div>
                <div class="mt-6 ml-4 pl-12 border-l-2 border-white/10 space-y-8">
                    <div class="rounded-2xl glass p-6">
                        <h3 class="text-lg font-semibold"><span class="lang-en">Which computer game do you want to
                                install?</span><span class="lang-si">ඔබ ඉන්ස්ටෝල් කිරීමට අවශ්‍ය පරිඝණක ක්‍රීඩාව මෙතනින්
                                කුමක්ද?</span></h3>
                        <div id="game-list" class="mt-4 grid grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-4"></div>
                        <div id="download-button-container" class="mt-6"></div>
                    </div>
                    <div class="rounded-2xl glass p-6">
                        <p class="text-white/80"><span class="lang-en">Click the download button above to download the
                                relevant patch files. Now drag and drop those two files into the Steam Tools on your
                                computer (as shown below). Then restart Steam Tools.</span><span class="lang-si">අදාල
                                patch files ඩවුන්ලෝඩ් කිරීමට ඉහත ඩවුන්ලෝඩ් බොත්තම ක්ලික් කරන්න. දැන් ඒ ෆයිල්ස් දෙක ඔබගේ
                                පරිඝණකයේ ඇති ස්ටීම් ටූල්ස් එකට ඇද දමන්න(පහත පරිදි). පසුව Steam Tools Restart
                                කරන්න.</span></p>
                        <img src="{% static 'images/drag_drop.gif' %}" alt="Drag and Drop GIF"
                            class="w-full h-auto rounded-lg mt-4 bg-white/5">
                    </div>
                </div>
            </section>

            <!-- Step 6: Install & Verify -->
            <section class="mb-12 transition-opacity duration-500">
                <div class="flex items-start justify-between gap-4">
                    <div class="flex items-start gap-4">
                        <div class="step-counter font-black text-6xl">6</div>
                        <div>
                            <h2 class="text-2xl font-bold"><span class="lang-en">Install & Verify Files</span><span
                                    class="lang-si">ගොනු Install කර Verify කරන්න</span></h2>
                        </div>
                    </div>
                    <button onclick="markSectionAsDone(this)"
                        class="p-2 rounded-full bg-white/10 hover:bg-green-500/50 transition-colors group flex-shrink-0"
                        aria-label="Mark as done">
                        <svg xmlns="http://www.w3.org/2000/svg"
                            class="h-6 w-6 text-green-400 group-hover:text-white transition-colors" fill="none"
                            viewBox="0 0 24 24" stroke="currentColor">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7" />
                        </svg>
                    </button>
                </div>
                <div class="mt-6 ml-4 pl-12 border-l-2 border-white/10 space-y-8">
                    <div class="rounded-2xl glass p-6">
                        <p class="text-white/80"><span class="lang-en">Now copy all the DVDs we sent you to one folder.
                                Extract all of them with WinRAR.</span><span class="lang-si">දැන් අප ඔබට එවූ DVD සියල්ල
                                එක ෆෝල්ඩර් එකකට කොපි කරන්න. දැන් ඒ සියල්ල winrar මගින් extract කර ගන්න.</span></p>
                    </div>
                    <div class="rounded-2xl glass p-6">
                        <p class="text-white/80"><span class="lang-en">Now go to the Library of your Steam account. Your
                                game will be there. Click Install. After about 10MB has downloaded, click Pause. Now
                                find your game in the list on the left corner as follows, right-click on it and go to
                                Manage --> Browse Local Files.</span><span class="lang-si">දැන් ඔබගේ Steam එකවුන්ට් එකේ
                                Library එකට යන්න. ඔබගේ ගේම් එක එතන ඇති. එයට Install දෙන්න. 10MB පමණ ඩවුන්ලෝඩ් වූ පසු
                                Pause දෙන්න. දැන් පහත පරිදි ඔබගේ ගේම් එක වම් කෙලවරේ ලිස්ට් එකෙන් සොයාගෙන එය මත රයිට්
                                ක්ලික් කර Manage --> Browse Local Files දෙන්න.</span></p>
                        <img src="{% static 'images/browse_local.gif' %}" alt="Browse Local Files GIF"
                            class="w-full h-auto rounded-lg mt-4 bg-white/5">
                    </div>
                    <div class="rounded-2xl glass p-6">
                        <p class="text-white/80"><span class="lang-en">Now copy the files you extracted to the folder
                                that opened (in the pop-up that appears, select "copy and replace").</span><span
                                class="lang-si">දැන් ඕපන් වූ ෆෝල්ඩර් එකට ඔබ extract කරගත් files ටික කොපි කරන්න (එහිදී එන
                                pop-up එකේ copy and replace) දෙන්න.</span></p>
                        <img src="{% static 'images/copy_replace.gif' %}" alt="Copy and Replace GIF"
                            class="w-full h-auto rounded-lg mt-4 bg-white/5">
                    </div>
                    <div class="rounded-2xl glass p-6">
                        <p class="text-white/80"><span class="lang-en">Now again, find your game in the list on the left
                                corner, right-click on it and go to Properties --> Installed Files --> Verify integrity
                                of Game Files (this may take from 10 minutes to two hours).</span><span
                                class="lang-si">දැන් නැවත ඔබගේ ගේම් එක වම් කෙලවරේ ලිස්ට් එකෙන් සොයාගෙන එය මත රයිට්
                                ක්ලික් කර Properties --> Installed Files --> Verify integrity of Game Files දෙන්න(මෙයට
                                විනාඩි 10 සිට පැය දෙකක් පමණ ගත විය හැක).</span></p>
                        <img src="{% static 'images/verify_integrity.gif' %}" alt="Verify Integrity GIF"
                            class="w-full h-auto rounded-lg mt-4 bg-white/5">
                    </div>
                </div>
            </section>

            <!-- Step 7: Final Step -->
            <section class="transition-opacity duration-500">
                <div class="flex items-start justify-between gap-4">
                    <div class="flex items-start gap-4">
                        <div class="step-counter font-black text-6xl">7</div>
                        <div>
                            <h2 class="text-2xl font-bold"><span class="lang-en">Request Activation</span><span
                                    class="lang-si">සක්‍රිය කිරීම ඉල්ලන්න</span></h2>
                        </div>
                    </div>
                    <button onclick="markSectionAsDone(this)"
                        class="p-2 rounded-full bg-white/10 hover:bg-green-500/50 transition-colors group flex-shrink-0"
                        aria-label="Mark as done">
                        <svg xmlns="http://www.w3.org/2000/svg"
                            class="h-6 w-6 text-green-400 group-hover:text-white transition-colors" fill="none"
                            viewBox="0 0 24 24" stroke="currentColor">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7" />
                        </svg>
                    </button>
                </div>
                <div class="mt-6 ml-4 pl-12 border-l-2 border-white/10">
                    <div class="rounded-2xl glass p-6 bg-gradient-to-r from-brand-500/20 to-gold-400/20">
                        <p class="text-white/90"><span class="lang-en">While that is happening, go to <a
                                    href="https://www.virtuallabgames.com/my-tickets" target="_blank"
                                    class="text-gold-400 font-bold hover:underline">our support page</a>, select your
                                order correctly and submit a ticket. For the ticket title, mention the game name and
                                "activation". For the description, mention a phone number we can contact. We will
                                contact you at your desired time and activate your game within 5 minutes.</span><span
                                class="lang-si">එය සිදුවන අතරතුර, <a href="https://www.virtuallabgames.com/my-tickets"
                                    target="_blank" class="text-gold-400 font-bold hover:underline">අපගේ සහාය පිටුවට</a>
                                ගොස්, ඔබගේ ඇණවුම නිවැරදිව තෝරා ටිකට් පතක් ඉදිරිපත් කරන්න. ටිකට් මාතෘකාව සඳහා, ක්‍රීඩාවේ
                                නම සහ "සක්‍රිය කිරීම" සඳහන් කරන්න. විස්තරය සඳහා, අපට සම්බන්ධ කර ගත හැකි දුරකථන අංකයක්
                                සඳහන් කරන්න. අපි ඔබ කැමති වේලාවට ඔබ හා සම්බන්ධ වී මිනිතුතු 5ක් ඇතුළත ඔබේ ක්‍රීඩාව
                                සක්‍රිය කරන්නෙමු.</span></p>
                    </div>
                </div>
            </section>
        </div>
    </main>

    <footer class="border-t border-white/10 mt-16">
        <div class="container mx-auto px-4 sm:px-6 lg:px-8 py-10 text-center text-sm text-white/60">© <span
                id="year"></span> Virtual Lab Games.</div>
    </footer>

    <script>
        document.addEventListener('DOMContentLoaded', function () {

            // --- Steam Account Form Logic ---
            const steamAccountSection = document.getElementById('steam-account-section');
            const steamAccountForm = document.getElementById('steamAccountForm');
            const steamUsernameInput = document.getElementById('steam_username');
            const steamEmailInput = document.getElementById('steam_email');
            const steamFormActionContainer = document.getElementById('steam-form-action-container');
            const submitSteamDetailsBtn = document.getElementById('submitSteamDetailsBtn');

            function getCookie(name) {
                const match = document.cookie.match(new RegExp('(^|; )' + name + '=([^;]*)'));
                return match ? decodeURIComponent(match[2]) : null;
            }

            async function fetchJSON(url, opts = {}) {
                const headers = { 'Content-Type': 'application/json', ...(opts.headers || {}) };
                const merged = { credentials: 'same-origin', ...opts, headers };
                const res = await fetch(url, merged);
                if (res.status === 401 || res.status === 403) {
                    throw new Error('User not authenticated');
                }
                const data = await res.json().catch(() => ({}));
                if (!res.ok) throw new Error((data && (data.detail || data.error)) || `Request failed (${res.status})`);
                return data;
            }

            async function loadAndSetupSteamSection() {
                try {
                    const user = await fetchJSON('/api/me');
                    if (user.steam_username && user.steam_email) {
                        steamUsernameInput.value = user.steam_username;
                        steamEmailInput.value = user.steam_email;
                        steamUsernameInput.disabled = true;
                        steamEmailInput.disabled = true;
                        steamAccountSection.classList.add('section-done');
                        if (submitSteamDetailsBtn) submitSteamDetailsBtn.style.display = 'none';
                    } else {
                        steamUsernameInput.disabled = false;
                        steamEmailInput.disabled = false;
                    }
                } catch (error) {
                    steamFormActionContainer.innerHTML = `
                        <div class="w-full text-center p-3 rounded-lg bg-white/10 text-white/70 font-semibold">
                            <span class="lang-en">Please <a href="/login" class="font-bold text-gold-400 hover:underline">log in</a> to save your details.</span>
                            <span class="lang-si">කරුණාකර మీ వివరాలను సేవ్ చేయడానికి <a href="/login" class="font-bold text-gold-400 hover:underline">లాగిన్ అవ్వండి</a>.</span>
                        </div>
                    `;
                    steamUsernameInput.disabled = true;
                    steamEmailInput.disabled = true;
                }
            }

            if (steamAccountForm) {
                steamAccountForm.addEventListener('submit', async (e) => {
                    e.preventDefault();
                    const payload = {
                        steam_username: steamUsernameInput.value,
                        steam_email: steamEmailInput.value
                    };
                    if (!payload.steam_username || !payload.steam_email) {
                        alert('Please fill in both Steam Username and E-mail fields.');
                        return;
                    }
                    try {
                        await fetchJSON('/api/me/update', {
                            method: 'PATCH',
                            headers: { 'X-CSRFToken': getCookie('csrftoken') },
                            body: JSON.stringify(payload)
                        });
                        steamUsernameInput.disabled = true;
                        steamEmailInput.disabled = true;
                        steamAccountSection.classList.add('section-done');
                        if (submitSteamDetailsBtn) submitSteamDetailsBtn.style.display = 'none';
                    } catch (error) {
                        alert('Failed to save details: ' + error.message);
                    }
                });
            }

            loadAndSetupSteamSection();


            // --- Language toggle logic ---
            const langToggleBtn = document.getElementById('langToggleBtn');
            const body = document.body;

            const setLanguage = (lang) => {
                const isSi = lang === 'si';
                body.classList.toggle('sinhala-mode', isSi);
                if (langToggleBtn) langToggleBtn.textContent = isSi ? 'SI' : 'EN';
                localStorage.setItem('language', lang);
            };

            const toggleLanguage = () => {
                const currentLang = localStorage.getItem('language') || 'en';
                setLanguage(currentLang === 'en' ? 'si' : 'en');
            };

            langToggleBtn?.addEventListener('click', toggleLanguage);
            setLanguage(localStorage.getItem('language') || 'en');

            // --- Mark section as done ---
            window.markSectionAsDone = function (button) {
                const section = button.closest('section');
                if (section) {
                    section.classList.toggle('section-done');
                }
            }

            // --- Interactive Option Toggle ---
            window.toggleOption = function (button, idToShow) {
                const parent = button.parentElement;
                parent.querySelectorAll('.radio-button').forEach(btn => btn.classList.remove('selected'));
                button.classList.add('selected');

                const relatedIds = ['steam-yes', 'steam-no', 'steam-tools-yes', 'steam-tools-no', 'winrar-yes', 'winrar-no'];
                relatedIds.forEach(id => {
                    const el = document.getElementById(id);
                    if (el && el.parentElement === parent.parentElement) {
                        el.classList.add('hidden');
                    }
                });

                const elementToShow = document.getElementById(idToShow);
                if (elementToShow) elementToShow.classList.remove('hidden');
            }

            // --- GIF Viewer Logic ---
            window.showGifs = function (version, event) {
                const button = event.currentTarget;
                const parent = button.parentElement;
                parent.querySelectorAll('.radio-button').forEach(btn => btn.classList.remove('selected'));
                button.classList.add('selected');

                document.getElementById('win10-gifs').classList.remove('active');
                document.getElementById('win11-gifs').classList.remove('active');
                document.getElementById(version + '-gifs').classList.add('active');
            }

            // --- Game Selection Logic ---
            const gameListContainer = document.getElementById('game-list');
            const downloadButtonContainer = document.getElementById('download-button-container');

            async function loadGames() {
                if (gameListContainer) {
                    gameListContainer.innerHTML = '<p class="text-center text-white/70 col-span-full">Loading games...</p>';
                }

                try {
                    const response = await fetch('/api/offline-games/');
                    if (!response.ok) {
                        throw new Error(`API error! status: ${response.status}`);
                    }
                    const games = await response.json();

                    if (gameListContainer) {
                        gameListContainer.innerHTML = ''; // Clear loading message
                        if (games.length === 0) {
                            gameListContainer.innerHTML = '<p class="text-center text-white/70 col-span-full">No games available right now.</p>';
                            return;
                        }

                        games.forEach(game => {
                            const gameCard = document.createElement('div');
                            gameCard.className = 'game-card p-2 rounded-lg cursor-pointer border-2 border-transparent hover:border-gold-400 transition-all glass';
                            // The API provides 'image' and 'video' (for the file URL)
                            gameCard.onclick = (event) => selectGame(game.video, game.name, event.currentTarget);
                            gameCard.innerHTML = `
                                <img src="${game.image || 'https://placehold.co/300x400/101014/FFF?text=No+Image'}" alt="${game.name}" class="w-full h-auto rounded-md object-cover aspect-[3/4]">
                                <p class="text-center text-sm font-semibold mt-2">${game.name}</p>`;
                            gameListContainer.appendChild(gameCard);
                        });
                    }
                } catch (error) {
                    console.error("Failed to load games:", error);
                    if (gameListContainer) {
                        gameListContainer.innerHTML = '<p class="text-center text-danger-500 col-span-full">Could not load games. Please try again later.</p>';
                    }
                }
            }

            window.selectGame = function (downloadUrl, gameName, selectedCard) {
                if (gameListContainer) {
                    gameListContainer.querySelectorAll('.game-card').forEach(card => card.classList.remove('border-gold-400', 'bg-white/10'));
                }
                selectedCard.classList.add('border-gold-400', 'bg-white/10');

                if (downloadButtonContainer) {
                    if (downloadUrl) {
                        downloadButtonContainer.innerHTML = `<a href="${downloadUrl}" download class="inline-block text-center w-full py-3 px-6 rounded-xl bg-gradient-to-r from-brand-500 to-gold-400 text-white font-bold shadow-lg hover:shadow-xl transition-all">Download Files for ${gameName}</a>`;
                    } else {
                        downloadButtonContainer.innerHTML = `<p class="text-center text-white/70 mt-4">No download file is available for ${gameName}.</p>`;
                    }
                }
            }

            // Load the games from the API when the page is ready
            loadGames();


            // --- Footer year ---
            document.getElementById('year').textContent = new Date().getFullYear();
        });
    </script>
</body>

</html>